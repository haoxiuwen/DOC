# 用户关系

TODO:// 下面是腾讯云的文档，参考写一下环信 IM  的吧。

即时通信 IM 开放了用户关系托管能力，提供关系链相关的一整套完整解决方案。如果你不希望自行开发或维护 App 内用户之间的好友关系，并且轻松玩转加删好友等一系列功能，那么您可以选择即时通信 IM 的关系链托管服务：

- 即时通信 IM 提供关系链的存储能力，并确保你的数据具备异地容灾、多地部署和自动扩容缩容的能力，帮助你从服务器宕机、多拷贝主从复制和扩容缩容等复杂处理流程中得到完全地解放。

- 即时通信 IM 提供业界通用的业务处理流程，帮助你在用户关系链的逻辑上彻底地解放。

- 即时通信 IM 提供专业的运营流程和运营团队，全年 99.99% 的稳定服务质量，帮助你为用户提供具有稳定口碑的服务。

- 即时通信 IM 提供简单易用的服务接口和快捷接入的帮助指引，全程为你提供星级服务。

用户关系是一组用于描述用户和其他用户关系的数据，即时通信 IM 目前支持好友列表和黑名单两种。

// TODO：好友和联系人有啥区别？貌似概念不是很明确

## 好友列表

App 可以将 App 的好友体系导入到环信即时通讯 IM 的用户关系管理模块。

### 将 app 用户的好友体系导入到环信 IM

环信即时通讯 IM 的用户关系管理模块提供了[导入好友列表](/document/server-side/user_relationship.html#导入好友列表)的 REST API。对于一个已上线的有很多现有用户的 app，你只需要写一个脚本，循环调用[导入好友列表 REST API](/document/server-side/user_relationship.html#导入好友列表) 即可。

### App 用户好友列表更新时同步更新环信账号的用户关系模块

环信即时通讯的用户关系管理模块提供了以下好友列表管理 REST API。每次 app 业务后台的用户的好友列表发生变化时，也需要在环信及时通讯 IM 上更新该 App 用户的好友体系。

- [添加好友](/document/server-side/user_relationship.html#添加好友)；
- [删除好友](/document/server-side/user_relationship.html#删除好友)；
- [设置好友备注](/document/server-side/user_relationship.html#设置好友备注)；
- [获取好友列表](/document/server-side/user_relationship.html#分页获取好友列表)；
- [添加用户至黑名单](/document/server-side/user_relationship.html#添加用户至黑名单)；
- [从黑名单中移除用户](/document/server-side/user_relationship.html#从黑名单中移除用户)；
- [获取黑名单列表](/document/server-side/user_relationship.html#获取黑名单列表)。

### 开启或关闭发送消息权限控制

单聊用户之间的消息通讯，包括好友之间和陌生人之间的通讯。例如，对于企业内部的移动办公 app 来说，企业内部同事之间可以互相发送消息，可能不需要消息发送权限控制，而对于一个交友类 app，可能要控制只有好友之间才能发送消息，陌生人之间若要发消息，需要发送好友邀请，同意加好友后才能发消息。

环信即时通信 IM 默认支持陌生人之间发送单聊消息，即无需添加好友即可聊天。若仅允许好友之间发送单聊消息，你需要按以下步骤开启好友关系检查。

1. 在环信即时通讯云的左侧导航栏中，选择 **即时通讯** > **服务概览**。
2. 在 **设置** 区域，点击 **好友关系检查**对应的 **打开**，则该功能的状态为**已开启**。若关闭该功能，点击 **关闭**。
   该功能开启后，SDK 会在用户发起单聊时检查好友关系，若用户向陌生人发送单聊消息，SDK 会提示错误码 221。

### 标配好友字段  // TODO：腾讯云的这个是加好友有这么多字段吗？

TODO：是只有一个 reason，表示加好友的原因？

好友备注算吗？

### 自定义好友字段

TODO：自定义好友字段支持吗？ K-V 格式吗？

### 添加好友

IM 是否支持直接添加好友，无需接受好友请求吗？


### 删除好友

删除联系人时会同时删除对方联系人列表中的该用户。没有单向删除的说法吧？

不支持批量删除好友吧。

### 单向/双向校验好友关系

// TODO：没有吧？


## 黑名单

每个用户都有一份黑名单，用于保存被拉黑的用户。

用户可以将任何用户加入黑名单，不论该用户与你是否是好友关系。黑名单上的用户无法向你发送消息，也无法发送好友申请。好友被加入黑名单后仍在好友列表上显示。

黑名单最多可添加 XXX 用户。

你可以[添加用户到黑名单](/document/android/user_relationship.html#添加用户到黑名单)、[将用户从黑名单移除](/document/android/user_relationship.html#将用户从黑名单移除)以及[从服务器和本地数据库获取黑名单](/document/android/user_relationship.html#从服务器获取黑名单列表)。

// TODO：没有单向和双向校验黑名单关系的功能？











